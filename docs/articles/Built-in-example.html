<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Built-in example • ProcessSpace</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Built-in example">
<meta property="og:description" content="ProcessSpace">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ProcessSpace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Built-in-example.html">Built-in example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Built-in example</h1>
                        <h4 class="author">Adam Cummings</h4>
            
            <h4 class="date">6/9/2020</h4>
      
      
      <div class="hidden name"><code>Built-in-example.Rmd</code></div>

    </div>

    
    
<div id="load-the-required-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#load-the-required-packages" class="anchor"></a>Load the required packages:</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(<span class="kw">echo</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(<span class="kw">message</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(<span class="kw">error</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(<span class="kw">warning</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ProcessSpace</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggmap</span>)</pre></body></html></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: package 'ggplot2' was built under R version 3.6.3</code></pre>
<pre><code>## Google's Terms of Service: https://cloud.google.com/maps-platform/terms/.</code></pre>
<pre><code>## Please cite ggmap if you use it! See citation("ggmap") for details.</code></pre>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">raster</span>)</pre></body></html></div>
<pre><code>## Loading required package: sp</code></pre>
</div>
<div id="load-the-data-files-and-check-them" class="section level1">
<h1 class="hasAnchor">
<a href="#load-the-data-files-and-check-them" class="anchor"></a>load the Data files and check them</h1>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">rasterDir</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"external/raster.tif"</span>, <span class="kw">package</span><span class="kw">=</span><span class="st">"ProcessSpace"</span>)
<span class="no">streamsDir</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"external/streams.shp"</span>, <span class="kw">package</span><span class="kw">=</span><span class="st">"ProcessSpace"</span>)
<span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span>(<span class="no">rasterDir</span>)
<span class="no">streams</span> <span class="kw">&lt;-</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_read.html">read_sf</a></span>(<span class="no">streamsDir</span>)

<span class="no">s</span> <span class="kw">&lt;-</span> <span class="kw pkg">raster</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/terrain.html">terrain</a></span>(<span class="no">r</span>, <span class="kw">opt</span><span class="kw">=</span><span class="st">"slope"</span>)
<span class="no">a</span> <span class="kw">&lt;-</span> <span class="kw pkg">raster</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/terrain.html">terrain</a></span>(<span class="no">r</span>, <span class="kw">opt</span><span class="kw">=</span><span class="st">"aspect"</span>)
<span class="no">h</span> <span class="kw">&lt;-</span> <span class="kw pkg">raster</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/hillShade.html">hillShade</a></span>(<span class="no">s</span>,<span class="no">a</span>)
<span class="no">h</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterToPoints.html">rasterToPoints</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>() + <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>,<span class="kw">fill</span><span class="kw">=</span><span class="no">layer</span>),<span class="kw">show.legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>) + <span class="fu">geom_sf</span>(<span class="kw">data</span><span class="kw">=</span><span class="no">streams</span>) +
  <span class="fu">geom_sf_label</span>(<span class="kw">data</span><span class="kw">=</span><span class="no">streams</span>,<span class="fu">aes</span>(<span class="kw">label</span><span class="kw">=</span><span class="no">LINKNO</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">3</span>,
                <span class="kw">label.padding</span><span class="kw">=</span><span class="fu">unit</span>(<span class="fl">.1</span>,<span class="st">"lines"</span>)) +
  <span class="fu">scale_fill_viridis_c</span>() + <span class="fu">theme_minimal</span>()</pre></body></html></div>
<p><img src="Built-in-example_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"># s %&gt;% rasterToPoints() %&gt;% data.frame() %&gt;% 
#   ggplot() + geom_tile(aes(x=x,y=y,fill=slope),show.legend = FALSE) + geom_sf(data=streams) +
#   geom_sf_label(data=streams,aes(label=LINKNO),size=3,
#                 label.padding=unit(.1,"lines")) +
#   scale_fill_viridis_c() + theme_minimal()</pre></body></html></div>
<p>We like the look of stream segments <em>12</em> and <em>20</em> for further investigation. Let’s pull those two aside and confirm we grabbed the right ones:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">targetStream</span> <span class="kw">&lt;-</span> <span class="no">streams</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">LINKNO</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">12</span>,<span class="fl">20</span>))
<span class="co">#Check that you grabbed the right streams:</span>
<span class="fu">ggplot</span>(<span class="no">streams</span>) + <span class="fu">geom_sf</span>() +
  <span class="fu">geom_sf</span>(<span class="kw">data</span><span class="kw">=</span><span class="no">targetStream</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"blue4"</span>,<span class="kw">size</span><span class="kw">=</span><span class="fl">3</span>,<span class="kw">alpha</span><span class="kw">=</span><span class="fl">.6</span>) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggmap/man/theme_nothing.html">theme_nothing</a></span>()</pre></body></html></div>
<p><img src="Built-in-example_files/figure-html/unnamed-chunk-2-1.png" width="384"></p>
</div>
<div id="lets-run-it-through-the-tool" class="section level1">
<h1 class="hasAnchor">
<a href="#lets-run-it-through-the-tool" class="anchor"></a>Lets run it through the tool!</h1>
<div id="first-generate-the-cross-sections" class="section level2">
<h2 class="hasAnchor">
<a href="#first-generate-the-cross-sections" class="anchor"></a>First, generate the cross sections:</h2>
<p>This places evenly spaced points along the selected stream file at the interval selected. Then it draws semi-permendicular cross sections at each point at for the length given. You need to indicate the general flow direction of the stream with cut1Dir and cut2Dir. If the stream flows West to East provide “W” and “E”, if it flows North to East provide “N”, “E”</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">transectObject</span> <span class="kw">&lt;-</span> <span class="no">targetStream</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/generateCrossSections.html">generateCrossSections</a></span>(<span class="kw">xSectionDensity</span> <span class="kw">=</span> <span class="kw pkg">units</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/as_units.html">as_units</a></span>(<span class="fl">20</span>,<span class="st">"m"</span>),
                        <span class="kw">googleZoom</span><span class="kw">=</span><span class="fl">16</span>,
                        <span class="kw">xSectionLength</span> <span class="kw">=</span> <span class="kw pkg">units</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/as_units.html">as_units</a></span>(<span class="fl">100</span>,<span class="st">"m"</span>),
                        <span class="kw">cut1Dir</span> <span class="kw">=</span> <span class="st">"W"</span>,
                        <span class="kw">cut2Dir</span> <span class="kw">=</span> <span class="st">"E"</span>)

<span class="no">transectObject</span>$<span class="no">satImage</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/ggmap/man/ggmap.html">ggmap</a></span>() +
  <span class="fu">geom_sf</span>(<span class="kw">data</span><span class="kw">=</span><span class="no">transectObject</span>$<span class="no">mainLine</span> <span class="kw">%&gt;%</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_transform.html">st_transform</a></span>(<span class="fl">4326</span>),
          <span class="kw">col</span><span class="kw">=</span><span class="st">"blue4"</span>,<span class="kw">alpha</span><span class="kw">=</span><span class="fl">.5</span>,<span class="kw">size</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">inherit.aes</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu">geom_sf</span>(<span class="kw">data</span><span class="kw">=</span><span class="no">transectObject</span>$<span class="no">ls0</span> <span class="kw">%&gt;%</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_transform.html">st_transform</a></span>(<span class="fl">4326</span>),
          <span class="kw">inherit.aes</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu">geom_sf</span>(<span class="kw">data</span><span class="kw">=</span><span class="no">transectObject</span>$<span class="no">rs0</span> <span class="kw">%&gt;%</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_transform.html">st_transform</a></span>(<span class="fl">4326</span>),
          <span class="kw">col</span><span class="kw">=</span><span class="st">"blue"</span>,<span class="kw">inherit.aes</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu">geom_sf</span>(<span class="kw">data</span><span class="kw">=</span><span class="no">transectObject</span>$<span class="no">leftSide</span> <span class="kw">%&gt;%</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_transform.html">st_transform</a></span>(<span class="fl">4326</span>),<span class="kw">inherit.aes</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu">geom_sf</span>(<span class="kw">data</span><span class="kw">=</span><span class="no">transectObject</span>$<span class="no">rightSide</span> <span class="kw">%&gt;%</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_transform.html">st_transform</a></span>(<span class="fl">4326</span>),
          <span class="kw">col</span><span class="kw">=</span><span class="st">"blue"</span>,<span class="kw">inherit.aes</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="Built-in-example_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="second-run-it-through-a-series-of-manipulations" class="section level2">
<h2 class="hasAnchor">
<a href="#second-run-it-through-a-series-of-manipulations" class="anchor"></a>Second, run it through a series of manipulations:</h2>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># transectObject &lt;- transectObject %&gt;%</span>
<span class="co">#   addTopoLines(rasterDir = rasterDir) %&gt;%</span>
<span class="co">#   addStreamChannels(rasterDir = rasterDir,streamChannelFile = streamsDir) %&gt;%</span>
<span class="co">#   addCrossSectionElevations(rasterDir = rasterDir) %&gt;%</span>
<span class="co">#   addProcessSpace() %&gt;%</span>
<span class="co">#   buildXSectionPlot(plotFileName = "exampleOutput.pdf",streamChannelFile = streamsDir) %&gt;%</span>
<span class="co">#   rasterPlotter(rasterDir = rasterDir)</span>


<span class="no">transectObject</span> <span class="kw">&lt;-</span> <span class="no">transectObject</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/allAtOnce.html">allAtOnce</a></span>(<span class="kw">outputFilename</span> <span class="kw">=</span> <span class="st">"exampleOutput.pdf"</span>,
                             <span class="kw">rasterDir</span> <span class="kw">=</span> <span class="no">rasterDir</span>,
                             <span class="kw">verticalCutoff</span><span class="kw">=</span><span class="fl">8</span>,
                             <span class="kw">streamChannelFile</span> <span class="kw">=</span> <span class="no">streamsDir</span>,
                             <span class="kw">returnObject</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                             <span class="kw">doExportSpatial</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<pre><code>## Adding TopoLines -- Completed in 0.03 mins.
## Adding Stream Channel Data -- Completed in 0.03 mins.
## Extracting Cross Section Elevations -- Completed in 0.06 mins.
## Calculating Process Space Polygons -- Completed in 0.14 mins.
## Generating Map Plot -- Completed in 0 mins.</code></pre>
<pre><code>## Generating Detrended Elevation Raster[inverse distance weighted interpolation]
##  -- Completed in 0.11 mins.</code></pre>
</div>
<div id="then-export-the-results-as-a-comprehensive-kmz-file" class="section level2">
<h2 class="hasAnchor">
<a href="#then-export-the-results-as-a-comprehensive-kmz-file" class="anchor"></a>Then export the results as a comprehensive KMZ file:</h2>
<p>This produces a KMZ file that contains the cross section plots imbedded. Clicking the points along the stream file pull up the cross section plots</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="../reference/exportSpatials.html">exportSpatials</a></span>(<span class="no">transectObject</span>,<span class="kw">sectionName</span> <span class="kw">=</span> <span class="st">"exampleOutput"</span>)</pre></body></html></div>
<pre><code>## Writing kml to:
## exampleOutput.kml
## There are 60 ggplots being generated</code></pre>
</div>
<div id="heres-what-the-detrended-raster-and-a-single-cross-section-plot-can-look-like" class="section level2">
<h2 class="hasAnchor">
<a href="#heres-what-the-detrended-raster-and-a-single-cross-section-plot-can-look-like" class="anchor"></a>Here’s what the detrended raster and a single cross section plot can look like:</h2>
<p>Regions of the map with lower elevations than the stream are green, regions similar in elevation to the stream are blue, and regions higher than the stream elevation go from red to tan.</p>
<div class="figure">
<img src="../../../Adam%20Cummings/ProcessSpace/vignettes/exampleOutput_temp_El_legend.png" alt="Detrended Raster"><p class="caption">Detrended Raster</p>
</div>
<div class="figure">
<img src="../../../Adam%20Cummings/ProcessSpace/vignettes/exampleOutput_temp_El.png" alt="Detrended Raster"><p class="caption">Detrended Raster</p>
</div>
<p>Cross section look like this: They are plotted as though you’re looking upstream (which comes naturally when then raster and cross sections are viewed 3D in google earth.) The blue and green bands show elevations within 1ft and 2ft of the stream channel. This particular transect shows the stream is captured by a highly incised channel and the terrain slopes downhill in either perpendicular direction from the stream path. Perhaps this is not a natural flow path?</p>
<div class="figure">
<img src="../../../Adam%20Cummings/ProcessSpace/vignettes/exampleOutput-Images/Transect_3_temp_.png" alt="Cross section Plot"><p class="caption">Cross section Plot</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Adam Cummings.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
